import React, { lazy, useState, useEffect } from "react";
import axios from "axios";
import "../../css/style.css";
import "regenerator-runtime";

const MentorCard = lazy(() => import("./MentorCard.component"));
const MainNavbar = lazy(() => import("./Navbar.component"));
import { SideBar, FeatureItem } from "./SideBar.component.jsx";
import { MainSection } from "./MainSection.component";

export default function HomePage() {
  const [mentorInfo, setMentorInfo] = useState([]);
  const [currenMajor, setCurrentMajor] = useState("All");

  function handleChangeMajor(major) {
    setCurrentMajor(major);
  }

  console.log(`Current major: ${currenMajor}`);

  useEffect(async () => {
    // loading mentorInfo form databse by call axios
    const profiles = await axios.get("http:/localhost:3000/profiles/");

    console.log(`Result: ${JSON.stringify(profiles)}`);

    //if (currenMajor === "All") {
    //setMentorInfo(profiles);
    //} else {
    //setMentorInfo(profiles.filter((mentor) => mentor.major === currenMajor));
    //}
  }, [currenMajor]);

  return (
    <>
      <MainNavbar
        currentMajor={currenMajor}
        handleChangeMajor={handleChangeMajor}
      />
      <div className="container">
        <SideBar>
          <FeatureItem
            url="/request-management"
            featureName="Requests management"
          />
          <FeatureItem
            url="/host-management"
            featureName="Hosting management"
          />
          <FeatureItem
            url="/join-management"
            featureName="Joining management"
          />
        </SideBar>
        <MainSection>
          {mentorInfo.map((info, index) => (
            <MentorCard key={index} info={info} />
          ))}
        </MainSection>
      </div>
    </>
  );
}
